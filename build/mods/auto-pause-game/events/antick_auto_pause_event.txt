# $conflict_prone=no

namespace = antick_auto_pause

antick_auto_pause.1 = {
	hidden = yes
	scope = combat_side

	immediate = {
		save_scope_as = battle_side

		scope:battle_side.combat.location = {
			save_scope_as = province
		}

		scope:battle_side.enemy_side.side_primary_participant = {
			save_scope_as = enemy_primary_participant
		}

		scope:battle_side.enemy_side.side_commander = {
			save_scope_as = side_commander
		}

		scope:battle_side.side_primary_participant = {
			trigger_event = antick_auto_pause.2
		}
	}
}

antick_auto_pause.2 = {
	type = letter_event
	opening = antick_auto_pause.1.t
	desc = antick_auto_pause.1.desc
	sender = scope:side_commander

	option = {
		name = antick_auto_pause.1.a
	}
}

antick_auto_pause.3 = {
	type = letter_event
	opening = antick_auto_pause.3.t
	desc = antick_auto_pause.3.desc
	sender = scope:councillor

	option = {
		name = antick_auto_pause.3.a
	}
}

antick_auto_pause.4 = {
	type = letter_event
	opening = antick_auto_pause.4.t
	desc = antick_auto_pause.4.desc
	sender = scope:previous_controller

	immediate = {
		scope:barony.title_province = {
			save_scope_as = province
		}
	}

	option = {
		name = antick_auto_pause.4.a
	}
}

antick_auto_pause.5 = {
	hidden = yes
	scope = army

	immediate = {
		root.army_commander = { save_scope_as = raid_leader }
		scope:raid_leader = {
			trigger_event = antick_auto_pause.6
		}
	}
}

antick_auto_pause.6 = {
	type = character_event
	title = antick_auto_pause.6.t
	desc = antick_auto_pause.6.desc
	theme = war
	override_background = {
		reference = burning_building
	}
	left_portrait = {
		character = scope:raid_leader
		animation = war_over_win
	}

	right_portrait = {
		character = scope:sacked_county_owner
		animation = fear
		triggered_animation = {
			trigger = {
				ai_vengefulness >= medium_positive_ai_value
				ai_boldness > high_negative_ai_value
			}
			animation = rage
		}
	}

	trigger = {
		scope:raid_leader = {
			is_alive = yes
		}
	}

	immediate = {
		if = {
			limit = { is_landed = no }
			liege.capital_province = { save_scope_as = capital_province }
		}
		else = {
			capital_province = { save_scope_as = capital_province }
		}

		scope:sacked_county.holder = { save_scope_as = sacked_county_owner }
		scope:county = { save_scope_as = sacked_county }
		scope:barony = { save_scope_as = sacked_barony }
	}

	option = {
		name = antick_auto_pause.6.a:0
	}
}
